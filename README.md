# Secure Qt Chat - 安全加密桌面聊天應用程式

這是一個基於 C++/Qt 6 開發的桌面即時通訊應用程式，採用 C/S (客戶端/伺-服器) 架構，其核心設計目標是實現一個功能完整且通訊過程高度安全的聊天平台。

使用者可以進行註冊、登入、與線上使用者進行一對一的即時文字通訊。所有客戶端與伺-服器之間的通訊均經過 SSL/TLS 協議加密，確保了數據的機密性和完整性。

## ✨ 主要功能

* **安全使用者認證**: 提供使用者註冊與登入功能，密碼採用加鹽雜湊 (Salted SHA-256) 方式儲存。
* **即時一對一聊天**: 支援與線上使用者進行私密的一對一文字訊息通訊。
* **線上使用者列表**: 客戶端即時顯示當前所有已登入的使用者。
* **加密通訊通道**: 所有網路通訊均透過 SSL/TLS 進行加密，有效防止中間人攻擊。
* **聊天記錄持久化**: 聊天歷史記錄會以 JSON Lines 格式安全地儲存在本地。

## 🛠️ 核心技術棧

* **開發語言與框架**:
    * **C++ 17**: 採用現代 C++ 標準進行開發。
    * **Qt 6**: 深度使用 Qt 框架，包括 `QtWidgets` (GUI), `QtNetwork` (網路通訊) 和 `QtCore` (核心功能)。

* **網路與安全**:
    * **C/S 架構**: 採用經典的客戶端/伺-服器模型。
    * **SSL/TLS**: 使用 `QSslSocket` 建立加密通訊通道。
    * **OpenSSL**: 用於建立自訂的根憑證頒發機構 (CA) 和伺服器憑證，以構建完整的本地信任鏈。
    * **非同步 I/O**: 基於 Qt 的信號與槽機制，實現了事件驅動的非阻塞式網路模型。
    * **自訂應用層協議**: 設計並實現了「消息頭(長度) + 消息體(JSON)」的協議，以解決 TCP 粘包問題。

* **數據處理**:
    * **JSON**: 作為客戶端與伺服器之間指令和數據交換的標準格式。
    * **JSON Lines**: 用於高效、穩健地儲存聊天記錄。

## 🚀 如何構建與執行

#### 1. 環境準備

* **Qt 6.x**: 確保您已安裝 Qt 6 或更高版本。
* **C++ 編譯器**: MSVC 2022(Windows)。
* **OpenSSL**: 確保您的系統已安裝 OpenSSL 命令列工具，以便產生憑證。

#### 2. 產生 SSL 憑證 (關鍵步驟)

在執行應用程式之前，您必須先建立一個本地的信任鏈。

1.  建立一個新的目錄 (例如 `certs`)，並在其中建立 `ca.cnf`, `server.cnf`, `v3.ext` 三個設定檔 (詳細內容請參考項目文件或原始碼)。
2.  開啟命令列/終端機，`cd` 到該目錄，並依次執行以下指令：

    ```
    # 1. 產生根 CA 的私鑰
    openssl genrsa -out rootCA.key 2048

    # 2. 產生根 CA 憑證
    openssl req -x509 -new -nodes -key rootCA.key -sha256 -days 1024 -out rootCA.crt -config ca.cnf

    # 3. 產生伺服器的私鑰
    openssl genrsa -out server.key 2048

    # 4. 產生伺服器憑證簽署請求 (CSR)
    openssl req -new -key server.key -out server.csr -config server.cnf

    # 5. 使用您的根 CA 簽署伺服器 CSR，產生最終的伺服器憑證
    openssl x509 -req -in server.csr -CA rootCA.crt -CAkey rootCA.key -CAcreateserial -out server.crt -days 365 -sha256 -extfile v3.ext
    ```

#### 3. 部署憑證

* **伺服器端**: 將 `server.key` 和 `server.crt` 複製到伺服器項目的資源目錄下 (例如 `:/ssl/`)。
* **客戶端**: 將 `rootCA.crt` 複製到客戶端項目的資源目錄下 (例如 `:/ssl/`)。

#### 4. 構建項目

1.  使用 Qt Creator 開啟項目的 `.pro` 檔案。
2.  設定好構建套件 (Kit)。
3.  **安裝客戶端信任 (首次執行)**:
    * **Windows**: 找到 `rootCA.crt` 檔案，雙擊它，並按照精靈指示將其安裝到「**受信任的根憑證授權單位**」存放區。
4.  分別構建 `Server` 和 `Client` 兩個子項目。

#### 5. 執行應用程式

1.  **啟動伺服器**: 執行構建好的伺服器程式。
3.  **啟動客戶端**: 執行一個或多個客戶端程式，您現在應該可以正常註冊、登入並聊天了。

## 📁 項目結構
```
.  
├── Client/         # 客戶端項目原始碼  
├── Server/         # 伺服器項目原始碼  
└── QtChat.pro  # Qt 項目主設定檔 (SUBDIRS 類型)  
```
